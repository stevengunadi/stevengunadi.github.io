<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Search news">
	<meta name="theme-color" content="#3f51b5"/>
	<link rel="apple-touch-icon" href="/images/icon/icon-192x192.png">
    <title>News Letter</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="css/materialize.min.css">
	<link rel="manifest" href="manifest.json">
	<style type="text/css">
		#loader {
			height: 100vh;
			align-items: center;
			display: flex;
			justify-content: center;

		}
		.progress {
			display: none;
		}
		.errorMsg {
			font-size: 34px;
			height: 100vh;
			align-items: center;
			display: flex;
			justify-content: center;
		}
	</style>
</head>
<body>
    <div class="navbar-fixed">
		<nav class="teal">
			<div class="nav-wrapper">
				<div class="container">
					<a href="#" class="brand-logo">News Api</a>
					<ul id="nav-mobile" class="right hide-on-med-and-down">
						<li class="active"><a href="index.html">News</a></li>
						<li><a href="about.html">About us</a></li>
						<li><a href="contact.html">Contact us</a></li>
					</ul>
				</div>

			</div>
		</nav>
	</div>
	<div class="container">
		<div class="row">
			<div id="newsResults"></div>
		</div>

		<div id="loader">
			<div class="progress">
				<div class="indeterminate"></div>
			</div>
		</div>
	</div>
	<script src="/script/jquery-3.3.1.min.js"></script>
	<script src="/script/materialize.min.js"></script>
	<script src="/sw.js"></script>
	<script>
		$(document).ready(function () {

    let url = "https://newsapi.org/v2/top-headlines?country=us&apiKey=267e8b25307f4216bf7eb86ae7b99748";
  
    $.ajax({
      url: url,
      method: "GET",
      dataType: "JSON",
  
      beforeSend: function () {
        $(".progress").show();
      },
  
      complete: function () {
        $(".progress").hide();
      },
  
      success: function (newsdata) {
        let output = "";
        let latestNews = newsdata.articles;
        for (var i in latestNews) {
          output += `
            <div class="col l4 m6 s12">
            <div class="card medium hoverable">
              <div class="card-image">
                <img src="${latestNews[i].urlToImage}" class="responsive-img" alt="${latestNews[i].title}">
              </div>
              <div class="card-content">
                <span class="card-title activator"><i class="material-icons right">more_vert</i></span>
                <h6 class="truncate">Title: <a href="${latestNews[i].url}" title="${latestNews[i].title}">${latestNews[i].title}</a></h6>
                <p><b>Author</b>: ${latestNews[i].author} </p>
                <p><b>News source</b>: ${latestNews[i].source.name} </p>
                <p><b>Published</b>: ${latestNews[i].publishedAt} </p>
              </div>
  
              <div class="card-reveal">
                <span class="card-title"><i class="material-icons right">close</i></span>
                <p><b>Description</b>: ${latestNews[i].description}</p>
              </div>
  
              <div class="card-action">
                <a href="${latestNews[i].url}" target="_blank" class="btn">Read More</a>
              </div>
             </div>
            </div>
          `;
        }
  
        if (output !== "") {
          $("#newsResults").html(output);
        }
  
      },
  
      error: function () {
        let errorMsg = `<div class="errorMsg center">Some error occured</div>`;
        $("#newsResults").html(errorMsg);
      }
    })
  
  });
	</script>
</body>
</html>
